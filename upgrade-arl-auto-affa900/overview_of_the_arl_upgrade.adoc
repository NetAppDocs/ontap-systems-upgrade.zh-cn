---
sidebar: sidebar 
permalink: upgrade-arl-auto-affa900/overview_of_the_arl_upgrade.html 
keywords: overview, arl, upgrade, owner, controller, hardware 
summary: 了解 AFF A700 到 AFF A900 ARL 控制器升级操作步骤 的工作原理。 
---
= ARL 升级概述
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
在使用 ARL 升级节点之前，您应了解操作步骤的工作原理。在此内容中，操作步骤将分为多个阶段。



== 升级节点对

要升级节点对，您需要准备原始节点，然后对原始节点和新节点执行一系列步骤。然后，您可以停用原始节点。



== ARL 升级顺序概述

在操作步骤期间，您可以使用替代控制器硬件升级原始控制器硬件，一次升级一个控制器，从而利用 HA 对配置重新定位非根聚合的所有权。所有非根聚合都必须进行两次重新定位，才能到达其最终目标，即正确的升级节点。

每个聚合都有一个主所有者和当前所有者。主所有者是聚合的实际所有者，当前所有者是临时所有者。

下表介绍了您在每个阶段执行的高级任务以及此阶段结束时的聚合所有权状态。操作步骤稍后将提供详细步骤：

[cols="35,65"]
|===
| 阶段 | 步骤 


| link:verify_upgrade_hardware.html["第 1 阶段：准备升级"]  a| 
. 验证升级硬件
. 运行预检以验证是否可以执行此操作
. 如果预检失败，请更正聚合所有权
. 输入集群基础许可证密钥
. 获取用于存储加密的 IP 地址
. 使用密钥管理可操作性协议（ Key Management 可操作性协议， KMIP ）服务器管理身份验证
. 使用板载密钥管理器（ OKM ）管理存储加密
. 暂停 SnapMirror 关系（可选）。


阶段 1 结束时的聚合所有权：

* node1 是 node1 聚合的主所有者和当前所有者
* node2 是 node2 聚合的主所有者和当前所有者




| link:relocate_non_root_aggr_and_nas_data_lifs_node1_node2.html["第 2 阶段：从 node1 重新定位资源并停用 AFF A700 node1"]  a| 
. 将节点 1 拥有的非根聚合和 NAS 数据 LIF 重新定位到节点 2
. 重新定位失败或被否决的聚合
. 停用 node1
. 卸下 AFF A700 控制器模块和 NVRAM 模块
. 在节点 1 上安装 AFF A900 NVRAM 模块和控制器模块
. 网络启动节点 1


阶段 2 结束时的聚合所有权：

* node2 是 node1 聚合的当前所有者
* node2 是 node2 聚合的主所有者和当前所有者




| link:boot_node1_with_a900_controller_and_nvs.html["第 3 阶段：使用 AFF A900 控制器模块 NVRAM 模块启动 node1"]  a| 
. 使用 AFF A900 控制器模块和 NVRAM 模块启动 node1
. 验证 node1 是否已成功安装
. 还原 node1 网络配置
. 在升级后的节点 1 上还原密钥管理器配置
. 将节点 1 拥有的非根聚合和 NAS 数据 LIF 从节点 2 移动到升级后的节点 1


第 3 阶段结束时的聚合所有权：

* 升级后的 AFF A900 node1 是 node1 聚合的主所有者和当前所有者
* node2 是 node2 聚合的主所有者和当前所有者




| link:relocate_non_root_aggr_nas_lifs_from_node2_to_node1.html["第 4 阶段：从 node2 重新定位资源并停用 node2"]  a| 
. 将非根聚合和 NAS 数据 LIF 从 node2 重新定位到 node1
. 停用 node2


第 4 阶段结束时的聚合所有权：

* 升级后的 node1 是最初属于 node1 的聚合的主所有者和当前所有者
* node2 是 node2 聚合的主所有者
* 升级后的 node1 是 node2 聚合的当前所有者




| link:install_a900_nvs_and_controller_on_node2.html["第 5 阶段：在节点 2 上安装 AFF A900 NVRAM 模块和控制器模块"]  a| 
. 在节点 2 上安装 AFF A900 NVRAM 模块和控制器模块
. 网络启动节点 2.


第 5 阶段结束时的聚合所有权：

* node1 是最初属于 node1 的聚合的主所有者和当前所有者。
* 升级后的 node2 是最初属于 node2 的聚合的主所有者和当前所有者。




| link:boot_node2_with_a900_controller_and_nvs.html["第 6 阶段：使用 AFF A900 控制器模块和 NVRAM 模块启动 node2"]  a| 
. 使用 AFF A900 控制器模块和 NVRAM 模块启动 node2
. 验证 node2 是否已正确安装
. 还原 node2 网络配置
. 将非根聚合和 NAS 数据 LIF 移回 node2




| link:ensure_new_controllers_are_set_up_correctly.html["第 7 阶段：完成升级"]  a| 
. 验证是否已正确设置新控制器
. 在新控制器模块上设置存储加密
. 在新控制器模块上设置 NetApp 卷加密。
. 停用旧系统。
. 恢复 NetApp SnapMirror 操作


|===